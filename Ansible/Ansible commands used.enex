<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE en-export SYSTEM "http://xml.evernote.com/pub/evernote-export3.dtd">
<en-export export-date="20200826T202411Z" application="Evernote" version="Evernote Mac 7.14 (458265)">
<note><title>Ansible commands used</title><content><![CDATA[<!DOCTYPE en-note SYSTEM "http://xml.evernote.com/pub/enml2.dtd"><en-note><div><u><b>Docker commands used to start and attach to Ansible  </b></u></div><div><font color="#be7210"><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; font-weight: bold;">~</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures;">$ sudo docker container list -a</span></font></div><div>
<font color="#be7210"><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; font-weight: bold;">~</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures;">$ sudo docker start infallible_wozniak</span></font></div><div>
<font color="#be7210"><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; font-weight: bold;">~</span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures;">$ sudo docker attach infallible_wozniak</span></font></div><div><span style="font: 13.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000;"><br /></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><u><b>Ansible is now attached and running. We now can create our Config files and Playbooks.</b></u></span></div><div><font><font face="Menlo" style="color: rgb(0, 35, 255); font-size: 11px;"><i><br /></i></font></font></div><div><font color="#0023ff"><font face="Menlo" style="font-size: 11px;"><i>Before we get started, </i></font><font face="Menlo"><span style="caret-color: rgb(0, 35, 255); font-size: 11px;"><i>let's</i></span></font><font face="Menlo" style="font-size: 11px;"><i> run a command to make sure we are connected to the </i></font><font face="Menlo" style="font-size: 11px; font-style: italic;">web servers.</font></font></div><div>
<span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures;"><font color="#be7210">~# ansible webservers -m ping</font></span></div><div><span style="font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures;"><font style="font-size: 11px;" color="#0023ff"><i>After running, all servers should show SUCCESS</i></font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 11px;"><br /></font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 13px;"><u><b>Now lets setup our Web Servers by editing ansible.cfg file</b></u></font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 13px;"><u><b><br /></b></u></font></span></div><div><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures;"><font color="#0023ff"><i style="font-family: Menlo; font-size: 11px; font-variant-caps: normal; font-weight: normal;">This command will </i><font face="Menlo"><span style="font-size: 11px;"><i>create</i></span></font><i style="font-family: Menlo; font-size: 11px; font-variant-caps: normal; font-weight: normal;"> file for you in the path specified. We want to show sudo_user = root and remote_user = sysadmin. To do so run this command to proceed to text editor.</i></font></span></div><div><span style="font-size: 13px; font-family: Menlo;"><font color="#be7210">~# nano /etc/ansible/ansible.cfg</font></span><br /></div><div><span style="font-size: 11px; color: rgb(0, 35, 255); font-family: Menlo;"><i><br /></i></span></div><div><font color="#0023ff"><i style="font-family: Menlo; font-size: 11px;">After text editing has been completed, we can now create a Playbook to setup Web1, Web2, </i><font face="Menlo"><span style="font-size: 11px;"><i>and</i></span></font><i style="font-family: Menlo; font-size: 11px;"> Web3 </i><font face="Menlo"><i style="font-size: 11px;">virtual servers. This is a </i><i style="font-size: 11px;">process of automation. We can now add additional </i><i style="font-size: 11px;">servers with very little no setup time needed.</i></font></font></div><div><font style="font-size: 13px; font-family: Menlo;">~# nano /etc/ansible/pentest.yml</font></div><div><font color="#0023ff"><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;">This command will </span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-family: Menlo; font-size: 11px; font-style: italic;">create</span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;"> file for you in the path specified. Below I show playbook ran.</span></font><br /></div><div>
<span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">---</font></span></div><div><span style="font: 13.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000;">   </span><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;"> - name: Config Web VM with Docker</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       hosts: webservers</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       become: true</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       tasks:</font></span></div><div><font style="font-size: 10px;"><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);">       - name: </span><a href="http://docker.io" style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(190, 114, 16);">docker.io</a></font></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">         apt:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          force_apt_get: yes</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          update_cache: yes</font></span></div><div><font style="font-size: 10px;"><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);">          name: </span><a href="http://docker.io" style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(190, 114, 16);">docker.io</a></font></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          state: present</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       - name: Install pip3</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">         apt:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          force_apt_get: yes</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          name: python3-pip</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          state: present</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       - name: Install Docker python module</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">         pip:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          name: docker</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          state: present</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       - name: download and launch a docker web container</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">         docker_container:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          name: dvwa</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          image: cyberxsecurity/dvwa</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          state: started</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          published_ports: 80:80</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">       - name: Enable docker service</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">         systemd:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          name: docker</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">          enabled: yes</font></span></div><div><span style="font-size: 11px; color: rgb(8, 21, 255); font-family: Menlo;"><br /></span></div><div><span style="font-size: 11px; font-family: Menlo;"><i><font color="#0023ff">Command to run playbook </font></i></span><br /></div><div><span style="font-size: 13px; font-family: Menlo;"><font color="#be7210">~# ansible-playbook /etc/ansible/pentest.yml</font></span></div><div><i><font color="#0023ff"><font face="Menlo"><span style="caret-color: rgb(11, 16, 255); font-size: 13px;">You're</span></font><span style="font-size: 13px; font-family: Menlo;"><font> all set!!!</font></span></font></i></div><div><span style="font-size: 13px; font-family: Menlo;"><i><font style="color: rgb(11, 16, 255);"><br /></font></i></span></div><div><b><u><font style="font-family: Menlo; font-size: 13px;">Now moving </font><font face="Menlo"><span style="caret-color: rgb(11, 16, 255); font-size: 13px;">forward</span></font><font style="font-family: Menlo; font-size: 13px;"> we have created a second Vm and connected to Ansible</font></u></b></div><div><font style="font-family: Menlo; font-size: 11px;" color="#0023ff">This machine will communicate to the web servers 1,2,3 and will log System Logs and Metric Data. This will require Filebeat and Metricbeat to be installed with additional config file and playbooks. </font></div><div><font style="font-family: Menlo; font-size: 11px;" color="#0023ff">Let's start with Filebeat.</font></div><div><font style="font-family: Menlo; font-size: 11px; color: rgb(10, 16, 255);"><br /></font></div><div><span style="font-size: 11px; font-family: Menlo;"><font color="#0023ff">First run command to create filebeat-config.yml</font><font style="color: rgb(8, 16, 255);"> </font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;" color="#be7210">~# nano /etc/ansible/files/filebeat-config.yml</font></span></div><div><font style="font-family: Menlo; font-size: 11px;" color="#0023ff">Inside text editor we want to change host to New VM <span style="caret-color: rgb(9, 14, 255);">“</span>ELK Stack” private IP address, username to “elastic”, and setup Kibana host to VM “Elk Stack" private IP address. Now you can exit from text editor.</font></div><div><font color="#090eff" face="Menlo" size="1"><br /></font></div><div><font color="#0023ff"><span style="font-style: italic; font-family: Menlo; font-size: 11px;">After text editing has been completed, we can now create a Playbook to setup Web1, Web2, </span><span style="font-family: Menlo; font-size: 11px; font-style: italic;">and</span><span style="font-style: italic; font-family: Menlo; font-size: 11px;"> Web3 </span><span style="font-family: Menlo; font-style: italic; font-size: 11px;">virtual servers.</span></font></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;" color="#be7210">~# nano /etc/ansible/roles/filebeat-playbook.yml</font></span></div><div><font color="#0023ff"><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;">This command will </span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-family: Menlo; font-size: 11px; font-style: italic;">create</span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;"> file for you in the path specified. Below I show playbook ran.</span></font></div><div>
<span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">---</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
- name: installing and launching filebeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  hosts: webservers</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  become: yes</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  tasks:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: download filebeat deb</font></span></div><div><font style="font-size: 10px;"><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);">    command: curl -L -O </span><a href="https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.4.0-amd64.deb" style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(190, 114, 16);">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.4.0-amd64.deb</a></font></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;"> </font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: install filebeat deb</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: dpkg -i filebeat-7.4.0-amd64.deb</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: drop in filebeat.yml </font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    copy:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">      src: /etc/ansible/files/filebeat-config.yml</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">      dest: /etc/filebeat/filebeat.yml</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: enable and configure system module</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: filebeat modules enable system</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: setup filebeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: filebeat setup</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: start filebeat service</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: service filebeat start</font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;"><br /></font></span></div><div><span style="font-family: Menlo;"><font color="#0023ff" style="font-size: 11px;">Command to run playbook</font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;" color="#be7210">~# ansible-playbook /etc/ansible/roles/filebeat-playbook.yml</font></span></div><div><font color="#0023ff"><font face="Menlo"><span style="caret-color: rgb(0, 35, 255); font-size: 11px;">You're</span></font><span style="font-family: Menlo;"><font style="font-size: 11px;"> all set!!!</font></span></font></div><div><span style="font-family: Menlo;"><font style="font-size: 11px; color: rgb(0, 35, 255);"><br /></font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 11px;" color="#0023ff">Now lets run command to create metricbeat-config.yml</font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;" color="#be7210">~# nano /etc/ansible/files/metricbeat-config.yml</font></span></div><div><font style="font-size: 11px;" color="#0023ff"><span style="font-family: Menlo;"><font>Inside text editor we want to change setup.Kibana host to New VM </font></span><font style="font-family: Menlo;">private IP address and port 5601, also we want to change Elasticsearch host to New VM private IP address </font></font></div><div><font color="#0023ff" style="font-size: 11px;"><font face="Menlo"><br /></font></font></div><div><font color="#0023ff"><span style="font-style: italic; font-family: Menlo; font-size: 11px;">After text editing has been completed, we can now create a Playbook to setup Web1, Web2, </span><span style="font-family: Menlo; font-size: 11px; font-style: italic;">and</span><span style="font-style: italic; font-family: Menlo; font-size: 11px;"> Web3 </span><span style="font-family: Menlo; font-style: italic; font-size: 11px;">virtual servers.</span></font></div><div><span style="font-family: Menlo; font-style: italic;"><font style="font-size: 13px;" color="#be7210">~# nano /etc/asnsible/roles/metricbeat-playbook.yml</font></span></div><div><font color="#0023ff"><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;">This command will </span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-family: Menlo; font-size: 11px; font-style: italic;">create</span><span style="font-stretch: normal; line-height: normal; font-variant-ligatures: no-common-ligatures; font-style: italic; font-family: Menlo; font-size: 11px;"> file for you in the path specified. Below I show playbook ran.</span></font></div><div>
<span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">---</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
- name: Install-metricbeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  hosts: webservers</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  become: true</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  tasks:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: Download metricbeat</font></span></div><div><font style="font-size: 10px;"><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);">    command: curl -L -O </span><a href="https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-7.4.0-amd64.deb" style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(190, 114, 16);">https://artifacts.elastic.co/downloads/beats/metricbeat/metricbeat-7.4.0-amd64.deb</a></font></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: install metricbeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: dpkg -i metricbeat-7.4.0-amd64.deb</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: drop in metricbeat config</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    copy:</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">      src: /etc/ansible/files/metricbeat-config.yml</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">      dest: /etc/metricbeat/metricbeat.yml</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: enable and configure docker module for metricbeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: metricbeat modules enable docker</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: setup metricbeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: metricbeat setup</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">  - name: start metricbeat</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">    command: metricbeat -e</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-style: normal; font-variant-caps: normal; font-weight: normal; font-stretch: normal; line-height: normal; font-family: Menlo; font-variant-ligatures: no-common-ligatures; color: rgb(0, 0, 0);"><font style="font-size: 10px;">
</font></span></div><div><span style="font-family: Menlo; font-style: italic;"><font style="font-size: 13px;"><br /></font></span></div><div><span style="font-family: Menlo; font-size: 11px;"><font color="#0023ff">Command to run playbook</font></span></div><div><span style="font-family: Menlo; font-size: 13px;"><font color="#be7210">~# ansible-playbook /etc/ansible/roles/metricbeat-playbook.yml</font></span></div><div><font color="#0023ff"><span style="font-family: Menlo; caret-color: rgb(0, 35, 255); font-size: 11px;">You're</span><span style="font-family: Menlo; font-size: 11px;"> all set!!!</span></font></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;"><br /></font></span></div><div><span style="font-family: Menlo;"><font style="font-size: 13px;"><br /></font></span></div><div><font color="#090eff" face="Menlo" size="1"><br /></font></div><div><font color="#090eff" face="Menlo" size="1"><br /></font></div><div><b><u><font style="font-family: Menlo; font-size: 13px;"><i><br /></i></font></u></b></div><div><span style="font-size: 11px; color: rgb(0, 0, 1); font-family: Menlo;"><i><br /></i></span></div></en-note>]]></content><created>20200826T170631Z</created><updated>20200826T202130Z</updated><note-attributes><latitude>37.26375854619427</latitude><longitude>-77.42922427636533</longitude><altitude>34.20143508911133</altitude><author>ltuppince@gmail.com</author><source>desktop.mac</source><reminder-order>0</reminder-order></note-attributes></note>
</en-export>
